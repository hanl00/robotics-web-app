{"version":3,"sources":["webpack:///../node_modules/@theia/monaco/src/browser/monaco-indexed-db.ts","webpack:///../node_modules/@theia/monaco/src/browser/monaco-languages.ts","webpack:///../node_modules/@theia/monaco/src/browser/monaco-theming-service.ts","webpack:///../node_modules/fast-plist/release/src/main.js","webpack:///../node_modules/idb/build/esm/chunk.js","webpack:///../node_modules/idb/build/esm/index.js"],"names":[],"mappings":";;;;;;;;;;;AAAA;;;;;;;;;;;;;;kFAckF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAElF,mFAA2B;AAC3B,wIAAqF;AAGrF,IAAI,SAAgD,CAAC;AACrD,IAAI,WAAW,IAAI,MAAM,EAAE;IACvB,SAAS,GAAG,GAAG,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC,EAAE;QACtC,OAAO,EAAE,YAAE;YACP,IAAI,CAAC,EAAE,CAAC,gBAAgB,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE;gBACzC,EAAE,CAAC,iBAAiB,CAAC,QAAQ,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;aACrD;QACL,CAAC;KACJ,CAAC,CAAC;CACN;AAEY,gBAAQ,GAAG,SAAS,CAAC;AASlC,IAAiB,gBAAgB,CAIhC;AAJD,WAAiB,gBAAgB;IAC7B,SAAgB,EAAE,CAAC,KAAyB;QACxC,OAAO,CAAC,CAAC,KAAK,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,IAAI,IAAI,KAAK,IAAI,OAAO,IAAI,KAAK,IAAI,SAAS,IAAI,KAAK,IAAI,MAAM,IAAI,KAAK,CAAC;IAC9H,CAAC;IAFe,mBAAE,KAEjB;AACL,CAAC,EAJgB,gBAAgB,GAAhB,wBAAgB,KAAhB,wBAAgB,QAIhC;AAED,SAAsB,SAAS;;;;;;oBAC3B,IAAI,CAAC,gBAAQ,EAAE;wBACX,sBAAO,EAAE,EAAC;qBACb;oBACU,qBAAM,gBAAQ;;oBAAnB,EAAE,GAAG,SAAc;oBACV,qBAAM,EAAE,CAAC,WAAW,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,MAAM,EAAE;;oBAAlF,MAAM,GAAG,SAAyE;oBACxF,sBAAO,MAAM,CAAC,MAAM,CAAC,gBAAgB,CAAC,EAAE,CAAC,EAAC;;;;CAC7C;AAPD,8BAOC;AAED,SAAgB,QAAQ,CAAC,KAAuB;IAC5C,IAAM,SAAS,GAAG,IAAI,iCAAoB,CAAC,uBAAU,CAAC,MAAM,CAAC,cAAmC,CAAC,CAAC,CAAC,CAAC;IACpG,UAAU,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;IAC7B,OAAO,SAAS,CAAC;AACrB,CAAC;AAJD,4BAIC;AACD,SAAe,UAAU,CAAC,KAAuB,EAAE,SAA+B;;;;;;oBAC9E,IAAI,CAAC,gBAAQ,EAAE;wBACX,sBAAO;qBACV;oBACU,qBAAM,gBAAQ;;oBAAnB,EAAE,GAAG,SAAc;oBACzB,IAAI,SAAS,CAAC,QAAQ,EAAE;wBACpB,sBAAO;qBACV;oBACK,EAAE,GAAG,KAAK,CAAC,EAAE,CAAC;oBACpB,qBAAM,EAAE,CAAC,WAAW,CAAC,QAAQ,EAAE,WAAW,CAAC,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC;;oBAA5E,SAA4E,CAAC;yBACzE,SAAS,CAAC,QAAQ,EAAlB,wBAAkB;oBAClB,qBAAM,WAAW,CAAC,EAAE,CAAC;;oBAArB,SAAqB,CAAC;oBACtB,sBAAO;;oBAEX,SAAS,CAAC,IAAI,CAAC,uBAAU,CAAC,MAAM,CAAC,cAAM,kBAAW,CAAC,EAAE,CAAC,EAAf,CAAe,CAAC,CAAC,CAAC;;;;;CAC5D;AAED,SAAsB,WAAW,CAAC,EAAU;;;;;;oBACxC,IAAI,CAAC,gBAAQ,EAAE;wBACX,sBAAO;qBACV;oBACU,qBAAM,gBAAQ;;oBAAnB,EAAE,GAAG,SAAc;oBACzB,qBAAM,EAAE,CAAC,WAAW,CAAC,QAAQ,EAAE,WAAW,CAAC,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC;;oBAA5E,SAA4E,CAAC;;;;;CAChF;AAND,kCAMC;;;;;;;;;;;;;;ACnFD;;;;;;;;;;;;;;kFAckF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAElF,qGAAyD;AACzD,qIAQ+B;AAE/B,+KAAoF;AACpF,mHAA6C;AAE7C,wIAA+D;AAC/D,oMAAoG;AAEpG,oBAAQ,CAAC,sBAAU,EAAE,EAAE,uCAAmB,CAAC,CAAC;AAC5C,oBAAQ,CAAC,kBAAM,CAAC,iDAAyB,CAAC,EAAE,uCAAmB,EAAE,CAAC,CAAC,CAAC;AACpE,oBAAQ,CAAC,kBAAM,CAAC,iDAAyB,CAAC,EAAE,uCAAmB,EAAE,CAAC,CAAC,CAAC;AAGpE;IAAqC,mCAAmB;IAMpD,yBAAa,qDAAqD;IAC3B,GAA8B,EAC9B,GAA8B,EACtB,cAA8B;;QAH7E,YAKI,kBAAM,GAAG,EAAE,GAAG,CAAC,SAKlB;QAP8C,oBAAc,GAAd,cAAc,CAAgB;QAPpE,8BAAwB,GAA8B,EAAE,CAAC;QAE/C,YAAM,GAAG,IAAI,GAAG,EAAsC,CAAC;;YAQtE,KAAkB,uBAAI,CAAC,cAAc,CAAC,OAAO,EAAE,6CAAE;gBAA5C,IAAM,GAAG;gBACV,KAAI,CAAC,aAAa,CAAC,IAAI,aAAG,CAAC,GAAG,CAAC,CAAC,CAAC;aACpC;;;;;;;;;QACD,KAAI,CAAC,cAAc,CAAC,kBAAkB,CAAC,aAAG,IAAI,YAAI,CAAC,aAAa,CAAC,GAAG,CAAC,EAAvB,CAAuB,CAAC,CAAC;;IAC3E,CAAC;IAES,uCAAa,GAAvB,UAAwB,GAAQ;;QAC5B,IAAM,SAAS,GAAG,GAAG,CAAC,QAAQ,EAAE,CAAC;QACjC,IAAM,MAAM,GAAG,IAAI,GAAG,EAAwB,CAAC;;YAC/C,KAAqB,sBAAI,CAAC,cAAc,CAAC,WAAW,CAAC,EAAE,GAAG,OAAE,CAAC,6CAAE;gBAA1D,IAAM,MAAM;gBACb,IAAM,WAAW,GAAG,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;gBACnD,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;gBAC9B,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC;aACzC;;;;;;;;;QACD,IAAM,OAAO,GAAG,IAAI,GAAG,CAAS,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC,CAAC;;YACpD,KAAmC,8BAAM,iFAAE;gBAAhC,oCAAoB,EAAnB,aAAK,EAAE,mBAAW;gBAC1B,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;gBACtB,IAAM,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,IAAI,yDAA0B,CAAC,KAAK,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC;gBAC7F,UAAU,CAAC,GAAG,CAAC,SAAS,EAAE,WAAW,CAAC,CAAC;gBACvC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,EAAE,UAAU,CAAC,CAAC;aACtC;;;;;;;;;;YACD,KAAoB,gCAAO,sFAAE;gBAAxB,IAAM,KAAK;gBACZ,IAAM,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;gBAC1C,IAAI,UAAU,EAAE;oBACZ,UAAU,CAAC,GAAG,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC;iBACjC;aACJ;;;;;;;;;IACL,CAAC;IAED,oDAA0B,GAA1B,UAA2B,IAAa;QAAxC,iBAcC;QAbG,IAAM,KAAK,GAAG,IAAI,IAAI,SAAS,CAAC;QAChC,IAAM,IAAI,GAAa,EAAE,CAAC;QAC1B,OAAO;YACH,GAAG,EAAE,UAAC,GAAG,EAAE,WAAW;gBAClB,KAAI,CAAC,cAAc,CAAC,UAAU,CAAC,IAAI,aAAG,CAAC,GAAG,CAAC,EAAE,KAAK,EAAE,WAAW,CAAC,CAAC;gBACjE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YACnB,CAAC;YACD,OAAO,EAAE;;;oBACL,KAAkB,0BAAI,uEAAE;wBAAnB,IAAM,GAAG;wBACV,KAAI,CAAC,cAAc,CAAC,UAAU,CAAC,IAAI,aAAG,CAAC,GAAG,CAAC,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC;qBAC3D;;;;;;;;;YACL,CAAC;SACJ,CAAC;IACN,CAAC;IAED,yDAA+B,GAA/B,UAAgC,QAAiC;QAAjE,iBAQC;QAPG,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC7C,OAAO,uBAAU,CAAC,MAAM,CAAC;YACrB,IAAM,KAAK,GAAG,KAAI,CAAC,wBAAwB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;YAC9D,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE;gBACd,KAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;aAClD;QACL,CAAC,CAAC,CAAC;IACP,CAAC;IAED,sBAAI,sCAAS;aAAb;YACI,gBAAW,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,SAAS,CAAC,YAAY,EAAE,CAAC,CAAC,MAAM,EAAE,EAAE;QAC9E,CAAC;;;OAAA;IAED,qCAAW,GAAX,UAAY,UAAkB;QAC1B,OAAO,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,SAAS,CAAC,YAAY,EAAE,CAAC,MAAM,CAAC,kBAAQ,IAAI,eAAQ,CAAC,EAAE,KAAK,UAAU,EAA1B,CAA0B,CAAC,CAAC,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;IAC/H,CAAC;IAES,wCAAc,GAAxB,UAAyB,UAAsD;;QAC3E,IAAM,SAAS,GAAG,IAAI,GAAG,EAA6B,CAAC;;YACvD,KAAqD,sCAAU,qGAAE;gBAAtD,6BAAsC,EAApC,UAAE,EAAE,oBAAO,EAAE,0BAAU,EAAE,wBAAS;gBAC3C,IAAM,MAAM,GAAG,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI;oBAChC,EAAE;oBACF,IAAI,EAAE,EAAE;oBACR,UAAU,EAAE,IAAI,GAAG,EAAE;oBACrB,SAAS,EAAE,IAAI,GAAG,EAAE;iBACvB,CAAC;gBACF,IAAI,CAAC,MAAM,CAAC,IAAI,IAAI,OAAO,IAAI,OAAO,CAAC,MAAM,EAAE;oBAC3C,MAAM,CAAC,IAAI,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;iBAC5B;gBACD,IAAI,UAAU,IAAI,UAAU,CAAC,MAAM,EAAE;;wBACjC,KAAwB,qDAAU,sGAAE;4BAA/B,IAAM,SAAS;4BAChB,MAAM,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;yBACpC;;;;;;;;;iBACJ;gBACD,IAAI,SAAS,IAAI,SAAS,CAAC,MAAM,EAAE;;wBAC/B,KAAuB,mDAAS,iGAAE;4BAA7B,IAAM,QAAQ;4BACf,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;yBAClC;;;;;;;;;iBACJ;gBACD,SAAS,CAAC,GAAG,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;aAC7B;;;;;;;;;;YACD,KAA6B,oCAAS,gGAAE;gBAA7B,uCAAc,EAAb,UAAE,EAAE,gBAAQ;gBACpB,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE;oBAChB,QAAQ,CAAC,IAAI,GAAG,EAAE,CAAC;iBACtB;aACJ;;;;;;;;;QACD,OAAO,SAAS,CAAC;IACrB,CAAC;IAES,qDAA2B,GAArC,UAAsC,QAA0B,EAAE,QAA+B;QAAjG,iBAqBC;QArBkG,2BAA8B;aAA9B,UAA8B,EAA9B,qBAA8B,EAA9B,IAA8B;YAA9B,0CAA8B;;QAC7H,IAAM,8BAA8B,YAAO,CAAC,QAAQ,CAAC,iBAAiB,IAAI,iBAAiB,IAAI,EAAE,CAAC,CAAC,CAAC;QACpG,IAAM,gCAAgC,YAAO,CAAC,QAAQ,CAAC,mBAAmB,IAAI,EAAE,CAAC,CAAC,CAAC;QACnF,OAAO;YACH,8BAA8B;YAC9B,gCAAgC;YAChC,oBAAoB,EAAE,UAAO,KAAK,EAAE,QAAQ,EAAE,KAAK;;;;;4BAC/C,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,6CAAqB,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,EAAE;gCACpE,sBAAO,SAAS,EAAC;6BACpB;4BACK,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,4BAA4B,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;4BACzD,qBAAM,QAAQ,CAAC,oBAAoB,CAAC,MAAM,EAAE,KAAK,EAAE,SAAU,CAAC,oBAAoB,CAAC;;4BAA1F,IAAI,GAAG,SAAmF;4BAChG,IAAI,CAAC,IAAI,EAAE;gCACP,sBAAO,SAAS,EAAC;6BACpB;4BACD,sBAAO;oCACH,KAAK,EAAE,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC;oCACrC,OAAO,EAAE,cAAQ,CAAC;iCACrB,EAAC;;;iBACL;SACJ,CAAC;IACN,CAAC;IAES,kDAAwB,GAAlC,UAAmC,QAA0B,EAAE,QAA4B;QAA3F,iBAiBC;QAhBG,OAAO;YACH,kBAAkB,EAAE,UAAO,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK;;;;;4BACnD,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,6CAAqB,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,EAAE;gCACpE,sBAAO,SAAU,EAAC;6BACrB;4BACK,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,kBAAkB,CAAC,KAAK,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;4BAClD,qBAAM,QAAQ,CAAC,kBAAkB,CAAC,MAAM,EAAE,KAAK,CAAC;;4BAA1D,OAAO,GAAG,SAAgD;4BAChE,IAAI,CAAC,OAAO,EAAE;gCACV,sBAAO,SAAU,EAAC;6BACrB;4BACD,sBAAO;oCACH,OAAO,EAAE,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,OAAO,CAAC;oCACxC,OAAO,EAAE,cAAQ,CAAC;iCACrB,EAAC;;;iBACL;SACJ,CAAC;IACN,CAAC;IAES,gDAAsB,GAAhC,UAAiC,QAA0B,EAAE,QAA0B;QAAvF,iBA6BC;QA5BG,OAAO;YACH,iBAAiB,EAAE,UAAO,KAAK,EAAE,KAAK;;;;;4BAClC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,6CAAqB,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,EAAE;gCACpE,sBAAO,SAAS,EAAC;6BACpB;4BACK,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;4BACjC,qBAAM,QAAQ,CAAC,iBAAiB,CAAC,MAAM,EAAE,KAAK,CAAC;;4BAAxD,MAAM,GAAG,SAA+C;4BAC9D,IAAI,CAAC,MAAM,EAAE;gCACT,sBAAO,SAAS,EAAC;6BACpB;4BACD,sBAAO;oCACH,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,MAAM,CAAC;oCACrC,OAAO,EAAE,cAAQ,CAAC;iCACrB,EAAC;;;iBACL;YACD,eAAe,EAAE,QAAQ,CAAC,eAAe,CAAC,CAAC,CAAC,UAAO,KAAK,EAAE,QAAQ,EAAE,KAAK;;;;;4BACrE,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,6CAAqB,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,EAAE;gCACpE,sBAAO,QAAQ,EAAC;6BACnB;4BACK,gBAAgB,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;4BACxC,qBAAM,QAAQ,CAAC,eAAgB,CAAC,gBAAgB,EAAE,KAAK,CAAC;;4BAAjE,MAAM,GAAG,SAAwD;4BACvE,IAAI,MAAM,EAAE;gCACF,gBAAgB,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;gCACrD,MAAM,CAAC,MAAM,CAAC,QAAQ,EAAE,gBAAgB,CAAC,CAAC;6BAC7C;4BACD,sBAAO,QAAQ,EAAC;;;iBACnB,CAAC,CAAC,CAAC,CAAC,UAAC,CAAC,EAAE,QAAQ,EAAE,EAAE,IAAK,eAAQ,EAAR,CAAQ,CAAC;SACtC,CAAC;IACN,CAAC;IAlLQ,eAAe;QAD3B,sBAAU,EAAE;QAQJ,6BAAM,CAAC,iDAAyB,CAAC;QACjC,6BAAM,CAAC,iDAAyB,CAAC;QACjC,6BAAM,CAAC,gCAAc,CAAC;yCAFiB,iDAAyB;YACzB,iDAAyB;YACN,gCAAc;OATpE,eAAe,CAoL3B;IAAD,sBAAC;CAAA,CApLoC,uCAAmB,GAoLvD;AApLY,0CAAe;;;;;;;;;;;;;;ACtC5B;;;;;;;;;;;;;;kFAckF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAElF,uDAAuD;AAEvD,qGAA+C;AAC/C,0GAA4C;AAC5C,0GAA0C;AAC1C,iIAAqF;AACrF,mHAA6C;AAC7C,wIAAqF;AACrF,oJAAqE;AACrE,yKAAuE;AACvE,2IAA4E;AAgC5E;IAAA;IAqJA,CAAC;6BArJY,oBAAoB;IAK7B,8DAA8D;IAC9D,uCAAQ,GAAR,UAAS,KAAkB,EAAE,OAA6C;QAA7C,sCAA6C;QACtE,IAAM,SAAS,GAAG,IAAI,iCAAoB,CAAC,uBAAU,CAAC,MAAM,CAAC,cAAmC,CAAC,CAAC,CAAC,CAAC;QACpG,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,OAAO,EAAE,SAAS,CAAC,CAAC;QAC3C,OAAO,SAAS,CAAC;IACrB,CAAC;IAEe,yCAAU,GAA1B,UAA2B,KAAkB,EACzC,OAAwC,EACxC,SAA+B;;;;;;;wBAGrB,QAAQ,GAAG,EAAE,CAAC;wBACP,qBAAM,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,EAAE,QAAQ,EAAE,OAAO,EAAE,SAAS,CAAC;;wBAApE,IAAI,GAAG,SAA6D;wBAC1E,IAAI,SAAS,CAAC,QAAQ,EAAE;4BACpB,sBAAO;yBACV;wBACK,KAAK,GAAG,KAAK,CAAC,KAAK,IAAI,IAAI,aAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;wBAClD,EAAE,GAA2B,KAAK,GAAhC,EAAE,WAAW,GAAc,KAAK,YAAnB,EAAE,OAAO,GAAK,KAAK,QAAV,CAAW;wBAC3C,SAAS,CAAC,IAAI,CAAC,sBAAoB,CAAC,QAAQ,CAAC,EAAE,EAAE,MAAE,KAAK,SAAE,WAAW,eAAE,OAAO,EAAE,OAAO,EAAE,IAAI,QAAE,QAAQ,YAAE,CAAC,CAAC,CAAC;;;;wBAE5G,OAAO,CAAC,KAAK,CAAC,4BAA4B,GAAG,KAAK,CAAC,GAAG,EAAE,GAAC,CAAC,CAAC;;;;;;KAElE;IAEe,wCAAS,GAAzB,UACI,GAAW,EACX,QAAoC,EACpC,OAAwC,EACxC,SAA+B;;;;;4BAGX,qBAAM,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,GAAG,CAAC;;wBAArD,OAAO,GAAK,UAAyC,SAA9C;wBACf,IAAI,SAAS,CAAC,QAAQ,EAAE;4BACpB,sBAAO;yBACV;wBACK,QAAQ,GAAG,IAAI,aAAG,CAAC,GAAG,CAAC,CAAC;wBAC9B,IAAI,QAAQ,CAAC,IAAI,CAAC,GAAG,KAAK,OAAO,EAAE;4BACzB,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;4BACzC,IAAI,KAAK,IAAI,UAAU,IAAI,KAAK,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE;gCAC/D,sBAAO,EAAE,WAAW,EAAE,KAAK,CAAC,QAAQ,EAAE,EAAC;6BAC1C;4BACD,MAAM,IAAI,KAAK,CAAC,mCAAiC,GAAG,+BAA4B,CAAC,CAAC;yBACrF;wBACK,IAAI,GAAG,WAAW,CAAC,KAAK,CAAC,OAAO,EAAE,SAAS,EAAE,EAAE,gBAAgB,EAAE,KAAK,EAAE,CAAC,CAAC;6BAC5E,cAAa,IAAI,IAAI,IAAI,OAAO,IAAI,CAAC,WAAW,KAAK,QAAQ,GAA7D,wBAA6D;wBAC/C,qBAAM,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,IAAI,CAAC,WAAW,EAAE,QAAQ,EAAE,OAAO,EAAE,SAAS,CAAC;;wBAAxF,KAAK,GAAG,SAAgF;wBAC9F,IAAI,SAAS,CAAC,QAAQ,EAAE;4BACpB,sBAAO;yBACV;wBACD,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC,WAAW,CAAC;;;6BAErC,IAAI,CAAC,OAAO,EAAZ,wBAAY;wBACZ,aAAQ;wBAAC,SAAI,CAAC,OAAO;wBAAI,qBAAM,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,IAAI,CAAC,OAAO,EAAE,QAAQ,EAAE,OAAO,EAAE,SAAS,CAAC;;wBAArG,MAAsB,GAAG,SAA4E,CAAC;wBACtG,IAAI,SAAS,CAAC,QAAQ,EAAE;4BACpB,sBAAO;yBACV;;4BAEL,sBAAO,IAAI,EAAC;;;;KACf;IAED,uDAAuD;IAC7C,0CAAW,GAArB,UACI,QAAa,EACb,cAAsB,EACtB,QAAoC,EACpC,OAAwC,EACxC,SAA+B;QAE/B,IAAM,aAAa,GAAG,QAAQ,CAAC,MAAM,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,QAAQ,EAAE,CAAC;QACzE,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,EAAE;YACzB,OAAO,CAAC,aAAa,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,EAAE,QAAQ,EAAE,OAAO,EAAE,SAAS,CAAC,CAAC;SACxF;QACD,OAAO,OAAO,CAAC,aAAa,CAAC,CAAC;IAClC,CAAC;IACD,sDAAsD;IAE/C,yBAAI,GAAX;QAAA,iBAIC;QAHG,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACzB,sBAAY,CAAC,GAAG,EAAE,CAAC,aAAa,CAAC,cAAM,YAAI,CAAC,iBAAiB,EAAE,EAAxB,CAAwB,CAAC,CAAC;QACjE,IAAI,CAAC,OAAO,EAAE,CAAC;IACnB,CAAC;IAEM,6BAAQ,GAAf,UAAgB,KAAsB;QAClC,IAAM,OAAO,GAAG,KAAK,CAAC,OAAO,IAAI,SAAS,CAAC;QACnC,uBAAK,EAAE,+BAAW,EAAE,iBAAI,EAAE,yBAAQ,CAAW;QACrD,IAAM,EAAE,GAAG,KAAK,CAAC,EAAE,IAAI,KAAK,CAAC;QAC7B,IAAM,WAAW,GAAG,sBAAoB,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;QAC3D,IAAM,IAAI,GAAG,2CAAmB,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,EAAE,QAAQ,EAAE,WAAW,EAAE,OAAO,CAAC,CAAC;QAC1F,OAAO,sBAAoB,CAAC,UAAU,CAAC,EAAE,EAAE,MAAE,KAAK,SAAE,WAAW,eAAE,OAAO,WAAE,IAAI,QAAE,CAAC,CAAC;IACtF,CAAC;IAGgB,sCAAiB,GAAlC;QACI,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;QAC/B,IAAM,IAAI,GAAG,sBAAY,CAAC,GAAG,EAAE,CAAC,eAAe,EAAE,CAAC,IAAI,CAAC;QACvD,IAAM,OAAO,GAA+B,IAAI,KAAK,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,KAAK,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC;QAC7G,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;QACrC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,uBAAU,CAAC,MAAM,CAAC,cAAM,eAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,EAAvC,CAAuC,CAAC,CAAC,CAAC;IAChG,CAAC;IAEgB,+BAAU,GAA3B,UAA4B,KAAuB;QACvC,iBAAE,EAAE,mBAAK,EAAE,+BAAW,EAAE,uBAAO,EAAE,iBAAI,CAAW;QACxD,IAAM,IAAI,GAAG,OAAO,KAAK,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,OAAO,KAAK,SAAS,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC;QAChF,IAAM,YAAY,GAAG,OAAO,KAAK,IAAI,CAAC,CAAC,CAAC,8BAAoB,CAAC,QAAQ,CAAC,CAAC,CAAC,8BAAoB,CAAC,OAAO,CAAC;QACrG,OAAO,IAAI,iCAAoB,CAC3B,sBAAY,CAAC,GAAG,EAAE,CAAC,QAAQ,CAAC;YACxB,IAAI;YACJ,EAAE;YACF,KAAK;YACL,WAAW,EAAE,WAAW;YACxB,WAAW,EAAE,IAAI,CAAC,IAAK;YACvB,QAAQ,EAAR;gBACI,YAAY,CAAC,GAAG,EAAE,CAAC;YACvB,CAAC;YACD,UAAU,EAAV;gBACI,YAAY,CAAC,KAAK,EAAE,CAAC;YACzB,CAAC;SACJ,CAAC,EACF,4BAAQ,CAAC,KAAK,CAAC,CAClB,CAAC;IACN,CAAC;IAEsB,4BAAO,GAA9B;;;;;;;;wBAEuB,qBAAM,6BAAS,EAAE;;wBAA1B,MAAM,GAAG,SAAiB;;4BAChC,KAAoB,0BAAM,iFAAE;gCAAjB,KAAK;gCACZ,2CAAmB,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,IAAK,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;gCACrE,sBAAoB,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;6BAC1C;;;;;;;;;;;;wBAED,OAAO,CAAC,KAAK,CAAC,iCAAiC,EAAE,GAAC,CAAC,CAAC;;;;;;KAE3D;IAED,uDAAuD;IACtC,kCAAa,GAA9B,UAA+B,GAAW;QACtC,GAAG,GAAG,GAAG,CAAC,OAAO,CAAC,iBAAiB,EAAE,GAAG,CAAC,CAAC;QAC1C,IAAI,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE;YAChC,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC;SACnB;QACD,OAAO,GAAG,CAAC;IACf,CAAC;;IAlDgB,oCAAe,GAAG,IAAI,iCAAoB,EAAE,CAAC;IA9F9D;QADC,kBAAM,CAAC,uBAAU,CAAC;;4DACuB;IAHjC,oBAAoB;QADhC,sBAAU,EAAE;OACA,oBAAoB,CAqJhC;IAAD,2BAAC;CAAA;AArJY,oDAAoB;;;;;;;;;;;;;AC1DjC;AACA;AACA;AACa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA,SAAS,0BAA0B;AACnC;AACA,SAAS,gBAAgB,KAAK,KAAK,OAAO,OAAO;AACjD;AACA,2BAA2B;AAC3B,0BAA0B;AAC1B,0BAA0B;AAC1B,4BAA4B;AAC5B,4BAA4B;AAC5B;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gC;;;;;;;;;;;;AClcA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,sBAAsB,EAAE;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEiG;;;;;;;;;;;;;ACpLjG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsD;AACF;;AAEpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,6BAA6B,KAAK;AAClE;AACA,wBAAwB,mDAAI;AAC5B;AACA;AACA,oBAAoB,mDAAI,sDAAsD,mDAAI;AAClF,SAAS;AACT;AACA;AACA;AACA;AACA,4FAA4F,EAAE;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,UAAU,KAAK;AACxC;AACA;AACA;AACA,WAAW,mDAAI;AACf;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAQ;AACR;AACA;AACA,CAAC;;AAE2B","file":"38.bundle.js","sourcesContent":["/********************************************************************************\n * Copyright (C) 2020 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport * as idb from 'idb';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\ntype ThemeMix = import('./textmate/monaco-theme-registry').ThemeMix;\n\nlet _monacoDB: Promise<idb.IDBPDatabase> | undefined;\nif ('indexedDB' in window) {\n    _monacoDB = idb.openDB('theia-monaco', 1, {\n        upgrade: db => {\n            if (!db.objectStoreNames.contains('themes')) {\n                db.createObjectStore('themes', { keyPath: 'id' });\n            }\n        }\n    });\n}\n\nexport const monacoDB = _monacoDB;\n\nexport interface MonacoThemeState {\n    id: string,\n    label: string,\n    description?: string,\n    uiTheme: monaco.editor.BuiltinTheme\n    data: ThemeMix\n}\nexport namespace MonacoThemeState {\n    export function is(state: Object | undefined): state is MonacoThemeState {\n        return !!state && typeof state === 'object' && 'id' in state && 'label' in state && 'uiTheme' in state && 'data' in state;\n    }\n}\n\nexport async function getThemes(): Promise<MonacoThemeState[]> {\n    if (!monacoDB) {\n        return [];\n    }\n    const db = await monacoDB;\n    const result = await db.transaction('themes', 'readonly').objectStore('themes').getAll();\n    return result.filter(MonacoThemeState.is);\n}\n\nexport function putTheme(state: MonacoThemeState): Disposable {\n    const toDispose = new DisposableCollection(Disposable.create(() => { /* mark as not disposed */ }));\n    doPutTheme(state, toDispose);\n    return toDispose;\n}\nasync function doPutTheme(state: MonacoThemeState, toDispose: DisposableCollection): Promise<void> {\n    if (!monacoDB) {\n        return;\n    }\n    const db = await monacoDB;\n    if (toDispose.disposed) {\n        return;\n    }\n    const id = state.id;\n    await db.transaction('themes', 'readwrite').objectStore('themes').put(state);\n    if (toDispose.disposed) {\n        await deleteTheme(id);\n        return;\n    }\n    toDispose.push(Disposable.create(() => deleteTheme(id)));\n}\n\nexport async function deleteTheme(id: string): Promise<void> {\n    if (!monacoDB) {\n        return;\n    }\n    const db = await monacoDB;\n    await db.transaction('themes', 'readwrite').objectStore('themes').delete(id);\n}\n","/********************************************************************************\n * Copyright (C) 2017 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, inject, decorate } from 'inversify';\nimport {\n    MonacoLanguages as BaseMonacoLanguages, ProtocolToMonacoConverter,\n    MonacoToProtocolConverter,\n    DocumentSelector,\n    SignatureHelpProvider,\n    MonacoModelIdentifier,\n    CodeActionProvider,\n    CodeLensProvider\n} from 'monaco-languageclient';\nimport { Languages, Diagnostic, DiagnosticCollection, Language, WorkspaceSymbolProvider } from '@theia/languages/lib/browser';\nimport { ProblemManager } from '@theia/markers/lib/browser/problem/problem-manager';\nimport URI from '@theia/core/lib/common/uri';\nimport { Mutable } from '@theia/core/lib/common/types';\nimport { Disposable } from '@theia/core/lib/common/disposable';\nimport { MonacoDiagnosticCollection } from 'monaco-languageclient/lib/monaco-diagnostic-collection';\n\ndecorate(injectable(), BaseMonacoLanguages);\ndecorate(inject(ProtocolToMonacoConverter), BaseMonacoLanguages, 0);\ndecorate(inject(MonacoToProtocolConverter), BaseMonacoLanguages, 1);\n\n@injectable()\nexport class MonacoLanguages extends BaseMonacoLanguages implements Languages {\n\n    readonly workspaceSymbolProviders: WorkspaceSymbolProvider[] = [];\n\n    protected readonly makers = new Map<string, MonacoDiagnosticCollection>();\n\n    constructor( // eslint-disable-next-line @typescript-eslint/indent\n        @inject(ProtocolToMonacoConverter) p2m: ProtocolToMonacoConverter,\n        @inject(MonacoToProtocolConverter) m2p: MonacoToProtocolConverter,\n        @inject(ProblemManager) protected readonly problemManager: ProblemManager\n    ) {\n        super(p2m, m2p);\n        for (const uri of this.problemManager.getUris()) {\n            this.updateMarkers(new URI(uri));\n        }\n        this.problemManager.onDidChangeMarkers(uri => this.updateMarkers(uri));\n    }\n\n    protected updateMarkers(uri: URI): void {\n        const uriString = uri.toString();\n        const owners = new Map<string, Diagnostic[]>();\n        for (const marker of this.problemManager.findMarkers({ uri })) {\n            const diagnostics = owners.get(marker.owner) || [];\n            diagnostics.push(marker.data);\n            owners.set(marker.owner, diagnostics);\n        }\n        const toClean = new Set<string>(this.makers.keys());\n        for (const [owner, diagnostics] of owners) {\n            toClean.delete(owner);\n            const collection = this.makers.get(owner) || new MonacoDiagnosticCollection(owner, this.p2m);\n            collection.set(uriString, diagnostics);\n            this.makers.set(owner, collection);\n        }\n        for (const owner of toClean) {\n            const collection = this.makers.get(owner);\n            if (collection) {\n                collection.set(uriString, []);\n            }\n        }\n    }\n\n    createDiagnosticCollection(name?: string): DiagnosticCollection {\n        const owner = name || 'default';\n        const uris: string[] = [];\n        return {\n            set: (uri, diagnostics) => {\n                this.problemManager.setMarkers(new URI(uri), owner, diagnostics);\n                uris.push(uri);\n            },\n            dispose: () => {\n                for (const uri of uris) {\n                    this.problemManager.setMarkers(new URI(uri), owner, []);\n                }\n            }\n        };\n    }\n\n    registerWorkspaceSymbolProvider(provider: WorkspaceSymbolProvider): Disposable {\n        this.workspaceSymbolProviders.push(provider);\n        return Disposable.create(() => {\n            const index = this.workspaceSymbolProviders.indexOf(provider);\n            if (index !== -1) {\n                this.workspaceSymbolProviders.splice(index, 1);\n            }\n        });\n    }\n\n    get languages(): Language[] {\n        return [...this.mergeLanguages(monaco.languages.getLanguages()).values()];\n    }\n\n    getLanguage(languageId: string): Language | undefined {\n        return this.mergeLanguages(monaco.languages.getLanguages().filter(language => language.id === languageId)).get(languageId);\n    }\n\n    protected mergeLanguages(registered: monaco.languages.ILanguageExtensionPoint[]): Map<string, Mutable<Language>> {\n        const languages = new Map<string, Mutable<Language>>();\n        for (const { id, aliases, extensions, filenames } of registered) {\n            const merged = languages.get(id) || {\n                id,\n                name: '',\n                extensions: new Set(),\n                filenames: new Set()\n            };\n            if (!merged.name && aliases && aliases.length) {\n                merged.name = aliases[0];\n            }\n            if (extensions && extensions.length) {\n                for (const extension of extensions) {\n                    merged.extensions.add(extension);\n                }\n            }\n            if (filenames && filenames.length) {\n                for (const filename of filenames) {\n                    merged.filenames.add(filename);\n                }\n            }\n            languages.set(id, merged);\n        }\n        for (const [id, language] of languages) {\n            if (!language.name) {\n                language.name = id;\n            }\n        }\n        return languages;\n    }\n\n    protected createSignatureHelpProvider(selector: DocumentSelector, provider: SignatureHelpProvider, ...triggerCharacters: string[]): monaco.languages.SignatureHelpProvider {\n        const signatureHelpTriggerCharacters = [...(provider.triggerCharacters || triggerCharacters || [])];\n        const signatureHelpRetriggerCharacters = [...(provider.retriggerCharacters || [])];\n        return {\n            signatureHelpTriggerCharacters,\n            signatureHelpRetriggerCharacters,\n            provideSignatureHelp: async (model, position, token) => {\n                if (!this.matchModel(selector, MonacoModelIdentifier.fromModel(model))) {\n                    return undefined;\n                }\n                const params = this.m2p.asTextDocumentPositionParams(model, position);\n                const help = await provider.provideSignatureHelp(params, token, undefined! /* not used by LC */);\n                if (!help) {\n                    return undefined;\n                }\n                return {\n                    value: this.p2m.asSignatureHelp(help),\n                    dispose: () => { }\n                };\n            }\n        };\n    }\n\n    protected createCodeActionProvider(selector: DocumentSelector, provider: CodeActionProvider): monaco.languages.CodeActionProvider {\n        return {\n            provideCodeActions: async (model, range, context, token) => {\n                if (!this.matchModel(selector, MonacoModelIdentifier.fromModel(model))) {\n                    return undefined!;\n                }\n                const params = this.m2p.asCodeActionParams(model, range, context);\n                const actions = await provider.provideCodeActions(params, token);\n                if (!actions) {\n                    return undefined!;\n                }\n                return {\n                    actions: this.p2m.asCodeActions(actions),\n                    dispose: () => { }\n                };\n            }\n        };\n    }\n\n    protected createCodeLensProvider(selector: DocumentSelector, provider: CodeLensProvider): monaco.languages.CodeLensProvider {\n        return {\n            provideCodeLenses: async (model, token) => {\n                if (!this.matchModel(selector, MonacoModelIdentifier.fromModel(model))) {\n                    return undefined;\n                }\n                const params = this.m2p.asCodeLensParams(model);\n                const lenses = await provider.provideCodeLenses(params, token);\n                if (!lenses) {\n                    return undefined;\n                }\n                return {\n                    lenses: this.p2m.asCodeLenses(lenses),\n                    dispose: () => { }\n                };\n            },\n            resolveCodeLens: provider.resolveCodeLens ? async (model, codeLens, token) => {\n                if (!this.matchModel(selector, MonacoModelIdentifier.fromModel(model))) {\n                    return codeLens;\n                }\n                const protocolCodeLens = this.m2p.asCodeLens(codeLens);\n                const result = await provider.resolveCodeLens!(protocolCodeLens, token);\n                if (result) {\n                    const resolvedCodeLens = this.p2m.asCodeLens(result);\n                    Object.assign(codeLens, resolvedCodeLens);\n                }\n                return codeLens;\n            } : ((_, codeLens, __) => codeLens)\n        };\n    }\n\n}\n","/********************************************************************************\n * Copyright (C) 2019 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport { injectable, inject } from 'inversify';\nimport * as jsoncparser from 'jsonc-parser';\nimport * as plistparser from 'fast-plist';\nimport { ThemeService, BuiltinThemeProvider } from '@theia/core/lib/browser/theming';\nimport URI from '@theia/core/lib/common/uri';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { FileSystem } from '@theia/filesystem/lib/common/filesystem';\nimport { MonacoThemeRegistry } from './textmate/monaco-theme-registry';\nimport { getThemes, putTheme, MonacoThemeState } from './monaco-indexed-db';\n\nexport interface MonacoTheme {\n    id?: string;\n    label?: string;\n    uiTheme?: monaco.editor.BuiltinTheme;\n    description?: string;\n    uri: string;\n}\n\nexport interface MonacoThemeJson {\n    /**\n     * theme id (optional), label is used if not provided\n     */\n    id?: string;\n    label: string;\n    /**\n     * theme type, `vs-dark` if not provided\n     */\n    uiTheme?: monaco.editor.BuiltinTheme;\n    description?: string;\n    /**\n     * Follow https://code.visualstudio.com/api/extension-guides/color-theme#create-a-new-color-theme to create a custom theme.\n     */\n    json: any\n    /**\n     * Themes can include each other. It specifies how inclusions should be resolved.\n     */\n    includes?: { [includePath: string]: any }\n}\n\n@injectable()\nexport class MonacoThemingService {\n\n    @inject(FileSystem)\n    protected readonly fileSystem: FileSystem;\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    register(theme: MonacoTheme, pending: { [uri: string]: Promise<any> } = {}): Disposable {\n        const toDispose = new DisposableCollection(Disposable.create(() => { /* mark as not disposed */ }));\n        this.doRegister(theme, pending, toDispose);\n        return toDispose;\n    }\n\n    protected async doRegister(theme: MonacoTheme,\n        pending: { [uri: string]: Promise<any> },\n        toDispose: DisposableCollection\n    ): Promise<void> {\n        try {\n            const includes = {};\n            const json = await this.loadTheme(theme.uri, includes, pending, toDispose);\n            if (toDispose.disposed) {\n                return;\n            }\n            const label = theme.label || new URI(theme.uri).path.base;\n            const { id, description, uiTheme } = theme;\n            toDispose.push(MonacoThemingService.register({ id, label, description, uiTheme: uiTheme, json, includes }));\n        } catch (e) {\n            console.error('Failed to load theme from ' + theme.uri, e);\n        }\n    }\n\n    protected async loadTheme(\n        uri: string,\n        includes: { [include: string]: any },\n        pending: { [uri: string]: Promise<any> },\n        toDispose: DisposableCollection\n    ): Promise<any> {\n        /* eslint-enable @typescript-eslint/no-explicit-any */\n        const { content } = await this.fileSystem.resolveContent(uri);\n        if (toDispose.disposed) {\n            return;\n        }\n        const themeUri = new URI(uri);\n        if (themeUri.path.ext !== '.json') {\n            const value = plistparser.parse(content);\n            if (value && 'settings' in value && Array.isArray(value.settings)) {\n                return { tokenColors: value.settings };\n            }\n            throw new Error(`Problem parsing tmTheme file: ${uri}. 'settings' is not array.`);\n        }\n        const json = jsoncparser.parse(content, undefined, { disallowComments: false });\n        if ('tokenColors' in json && typeof json.tokenColors === 'string') {\n            const value = await this.doLoadTheme(themeUri, json.tokenColors, includes, pending, toDispose);\n            if (toDispose.disposed) {\n                return;\n            }\n            json.tokenColors = value.tokenColors;\n        }\n        if (json.include) {\n            includes[json.include] = await this.doLoadTheme(themeUri, json.include, includes, pending, toDispose);\n            if (toDispose.disposed) {\n                return;\n            }\n        }\n        return json;\n    }\n\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    protected doLoadTheme(\n        themeUri: URI,\n        referencedPath: string,\n        includes: { [include: string]: any },\n        pending: { [uri: string]: Promise<any> },\n        toDispose: DisposableCollection\n    ): Promise<any> {\n        const referencedUri = themeUri.parent.resolve(referencedPath).toString();\n        if (!pending[referencedUri]) {\n            pending[referencedUri] = this.loadTheme(referencedUri, includes, pending, toDispose);\n        }\n        return pending[referencedUri];\n    }\n    /* eslint-enable @typescript-eslint/no-explicit-any */\n\n    static init(): void {\n        this.updateBodyUiTheme();\n        ThemeService.get().onThemeChange(() => this.updateBodyUiTheme());\n        this.restore();\n    }\n\n    static register(theme: MonacoThemeJson): Disposable {\n        const uiTheme = theme.uiTheme || 'vs-dark';\n        const { label, description, json, includes } = theme;\n        const id = theme.id || label;\n        const cssSelector = MonacoThemingService.toCssSelector(id);\n        const data = MonacoThemeRegistry.SINGLETON.register(json, includes, cssSelector, uiTheme);\n        return MonacoThemingService.doRegister({ id, label, description, uiTheme, data });\n    }\n\n    protected static toUpdateUiTheme = new DisposableCollection();\n    protected static updateBodyUiTheme(): void {\n        this.toUpdateUiTheme.dispose();\n        const type = ThemeService.get().getCurrentTheme().type;\n        const uiTheme: monaco.editor.BuiltinTheme = type === 'hc' ? 'hc-black' : type === 'light' ? 'vs' : 'vs-dark';\n        document.body.classList.add(uiTheme);\n        this.toUpdateUiTheme.push(Disposable.create(() => document.body.classList.remove(uiTheme)));\n    }\n\n    protected static doRegister(state: MonacoThemeState): Disposable {\n        const { id, label, description, uiTheme, data } = state;\n        const type = uiTheme === 'vs' ? 'light' : uiTheme === 'vs-dark' ? 'dark' : 'hc';\n        const builtInTheme = uiTheme === 'vs' ? BuiltinThemeProvider.lightCss : BuiltinThemeProvider.darkCss;\n        return new DisposableCollection(\n            ThemeService.get().register({\n                type,\n                id,\n                label,\n                description: description,\n                editorTheme: data.name!,\n                activate(): void {\n                    builtInTheme.use();\n                },\n                deactivate(): void {\n                    builtInTheme.unuse();\n                }\n            }),\n            putTheme(state)\n        );\n    }\n\n    protected static async restore(): Promise<void> {\n        try {\n            const themes = await getThemes();\n            for (const state of themes) {\n                MonacoThemeRegistry.SINGLETON.setTheme(state.data.name!, state.data);\n                MonacoThemingService.doRegister(state);\n            }\n        } catch (e) {\n            console.error('Failed to restore monaco themes', e);\n        }\n    }\n\n    /* remove all characters that are not allowed in css */\n    protected static toCssSelector(str: string): string {\n        str = str.replace(/[^\\-a-zA-Z0-9]/g, '-');\n        if (str.charAt(0).match(/[0-9\\-]/)) {\n            str = '-' + str;\n        }\n        return str;\n    }\n\n}\n","/*---------------------------------------------------------\r\n * Copyright (C) Microsoft Corporation. All rights reserved.\r\n *--------------------------------------------------------*/\r\n'use strict';\r\nfunction parseWithLocation(content, filename, locationKeyName) {\r\n    return _parse(content, filename, locationKeyName);\r\n}\r\nexports.parseWithLocation = parseWithLocation;\r\n/**\r\n * A very fast plist parser\r\n */\r\nfunction parse(content) {\r\n    return _parse(content, null, null);\r\n}\r\nexports.parse = parse;\r\nfunction _parse(content, filename, locationKeyName) {\r\n    var len = content.length;\r\n    var pos = 0;\r\n    var line = 1;\r\n    var char = 0;\r\n    // Skip UTF8 BOM\r\n    if (len > 0 && content.charCodeAt(0) === 65279 /* BOM */) {\r\n        pos = 1;\r\n    }\r\n    function advancePosBy(by) {\r\n        if (locationKeyName === null) {\r\n            pos = pos + by;\r\n        }\r\n        else {\r\n            while (by > 0) {\r\n                var chCode = content.charCodeAt(pos);\r\n                if (chCode === 10 /* LINE_FEED */) {\r\n                    pos++;\r\n                    line++;\r\n                    char = 0;\r\n                }\r\n                else {\r\n                    pos++;\r\n                    char++;\r\n                }\r\n                by--;\r\n            }\r\n        }\r\n    }\r\n    function advancePosTo(to) {\r\n        if (locationKeyName === null) {\r\n            pos = to;\r\n        }\r\n        else {\r\n            advancePosBy(to - pos);\r\n        }\r\n    }\r\n    function skipWhitespace() {\r\n        while (pos < len) {\r\n            var chCode = content.charCodeAt(pos);\r\n            if (chCode !== 32 /* SPACE */ && chCode !== 9 /* TAB */ && chCode !== 13 /* CARRIAGE_RETURN */ && chCode !== 10 /* LINE_FEED */) {\r\n                break;\r\n            }\r\n            advancePosBy(1);\r\n        }\r\n    }\r\n    function advanceIfStartsWith(str) {\r\n        if (content.substr(pos, str.length) === str) {\r\n            advancePosBy(str.length);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    function advanceUntil(str) {\r\n        var nextOccurence = content.indexOf(str, pos);\r\n        if (nextOccurence !== -1) {\r\n            advancePosTo(nextOccurence + str.length);\r\n        }\r\n        else {\r\n            // EOF\r\n            advancePosTo(len);\r\n        }\r\n    }\r\n    function captureUntil(str) {\r\n        var nextOccurence = content.indexOf(str, pos);\r\n        if (nextOccurence !== -1) {\r\n            var r = content.substring(pos, nextOccurence);\r\n            advancePosTo(nextOccurence + str.length);\r\n            return r;\r\n        }\r\n        else {\r\n            // EOF\r\n            var r = content.substr(pos);\r\n            advancePosTo(len);\r\n            return r;\r\n        }\r\n    }\r\n    var state = 0 /* ROOT_STATE */;\r\n    var cur = null;\r\n    var stateStack = [];\r\n    var objStack = [];\r\n    var curKey = null;\r\n    function pushState(newState, newCur) {\r\n        stateStack.push(state);\r\n        objStack.push(cur);\r\n        state = newState;\r\n        cur = newCur;\r\n    }\r\n    function popState() {\r\n        state = stateStack.pop();\r\n        cur = objStack.pop();\r\n    }\r\n    function fail(msg) {\r\n        throw new Error('Near offset ' + pos + ': ' + msg + ' ~~~' + content.substr(pos, 50) + '~~~');\r\n    }\r\n    var dictState = {\r\n        enterDict: function () {\r\n            if (curKey === null) {\r\n                fail('missing <key>');\r\n            }\r\n            var newDict = {};\r\n            if (locationKeyName !== null) {\r\n                newDict[locationKeyName] = {\r\n                    filename: filename,\r\n                    line: line,\r\n                    char: char\r\n                };\r\n            }\r\n            cur[curKey] = newDict;\r\n            curKey = null;\r\n            pushState(1 /* DICT_STATE */, newDict);\r\n        },\r\n        enterArray: function () {\r\n            if (curKey === null) {\r\n                fail('missing <key>');\r\n            }\r\n            var newArr = [];\r\n            cur[curKey] = newArr;\r\n            curKey = null;\r\n            pushState(2 /* ARR_STATE */, newArr);\r\n        }\r\n    };\r\n    var arrState = {\r\n        enterDict: function () {\r\n            var newDict = {};\r\n            if (locationKeyName !== null) {\r\n                newDict[locationKeyName] = {\r\n                    filename: filename,\r\n                    line: line,\r\n                    char: char\r\n                };\r\n            }\r\n            cur.push(newDict);\r\n            pushState(1 /* DICT_STATE */, newDict);\r\n        },\r\n        enterArray: function () {\r\n            var newArr = [];\r\n            cur.push(newArr);\r\n            pushState(2 /* ARR_STATE */, newArr);\r\n        }\r\n    };\r\n    function enterDict() {\r\n        if (state === 1 /* DICT_STATE */) {\r\n            dictState.enterDict();\r\n        }\r\n        else if (state === 2 /* ARR_STATE */) {\r\n            arrState.enterDict();\r\n        }\r\n        else {\r\n            cur = {};\r\n            if (locationKeyName !== null) {\r\n                cur[locationKeyName] = {\r\n                    filename: filename,\r\n                    line: line,\r\n                    char: char\r\n                };\r\n            }\r\n            pushState(1 /* DICT_STATE */, cur);\r\n        }\r\n    }\r\n    function leaveDict() {\r\n        if (state === 1 /* DICT_STATE */) {\r\n            popState();\r\n        }\r\n        else if (state === 2 /* ARR_STATE */) {\r\n            fail('unexpected </dict>');\r\n        }\r\n        else {\r\n            fail('unexpected </dict>');\r\n        }\r\n    }\r\n    function enterArray() {\r\n        if (state === 1 /* DICT_STATE */) {\r\n            dictState.enterArray();\r\n        }\r\n        else if (state === 2 /* ARR_STATE */) {\r\n            arrState.enterArray();\r\n        }\r\n        else {\r\n            cur = [];\r\n            pushState(2 /* ARR_STATE */, cur);\r\n        }\r\n    }\r\n    function leaveArray() {\r\n        if (state === 1 /* DICT_STATE */) {\r\n            fail('unexpected </array>');\r\n        }\r\n        else if (state === 2 /* ARR_STATE */) {\r\n            popState();\r\n        }\r\n        else {\r\n            fail('unexpected </array>');\r\n        }\r\n    }\r\n    function acceptKey(val) {\r\n        if (state === 1 /* DICT_STATE */) {\r\n            if (curKey !== null) {\r\n                fail('too many <key>');\r\n            }\r\n            curKey = val;\r\n        }\r\n        else if (state === 2 /* ARR_STATE */) {\r\n            fail('unexpected <key>');\r\n        }\r\n        else {\r\n            fail('unexpected <key>');\r\n        }\r\n    }\r\n    function acceptString(val) {\r\n        if (state === 1 /* DICT_STATE */) {\r\n            if (curKey === null) {\r\n                fail('missing <key>');\r\n            }\r\n            cur[curKey] = val;\r\n            curKey = null;\r\n        }\r\n        else if (state === 2 /* ARR_STATE */) {\r\n            cur.push(val);\r\n        }\r\n        else {\r\n            cur = val;\r\n        }\r\n    }\r\n    function acceptReal(val) {\r\n        if (isNaN(val)) {\r\n            fail('cannot parse float');\r\n        }\r\n        if (state === 1 /* DICT_STATE */) {\r\n            if (curKey === null) {\r\n                fail('missing <key>');\r\n            }\r\n            cur[curKey] = val;\r\n            curKey = null;\r\n        }\r\n        else if (state === 2 /* ARR_STATE */) {\r\n            cur.push(val);\r\n        }\r\n        else {\r\n            cur = val;\r\n        }\r\n    }\r\n    function acceptInteger(val) {\r\n        if (isNaN(val)) {\r\n            fail('cannot parse integer');\r\n        }\r\n        if (state === 1 /* DICT_STATE */) {\r\n            if (curKey === null) {\r\n                fail('missing <key>');\r\n            }\r\n            cur[curKey] = val;\r\n            curKey = null;\r\n        }\r\n        else if (state === 2 /* ARR_STATE */) {\r\n            cur.push(val);\r\n        }\r\n        else {\r\n            cur = val;\r\n        }\r\n    }\r\n    function acceptDate(val) {\r\n        if (state === 1 /* DICT_STATE */) {\r\n            if (curKey === null) {\r\n                fail('missing <key>');\r\n            }\r\n            cur[curKey] = val;\r\n            curKey = null;\r\n        }\r\n        else if (state === 2 /* ARR_STATE */) {\r\n            cur.push(val);\r\n        }\r\n        else {\r\n            cur = val;\r\n        }\r\n    }\r\n    function acceptData(val) {\r\n        if (state === 1 /* DICT_STATE */) {\r\n            if (curKey === null) {\r\n                fail('missing <key>');\r\n            }\r\n            cur[curKey] = val;\r\n            curKey = null;\r\n        }\r\n        else if (state === 2 /* ARR_STATE */) {\r\n            cur.push(val);\r\n        }\r\n        else {\r\n            cur = val;\r\n        }\r\n    }\r\n    function acceptBool(val) {\r\n        if (state === 1 /* DICT_STATE */) {\r\n            if (curKey === null) {\r\n                fail('missing <key>');\r\n            }\r\n            cur[curKey] = val;\r\n            curKey = null;\r\n        }\r\n        else if (state === 2 /* ARR_STATE */) {\r\n            cur.push(val);\r\n        }\r\n        else {\r\n            cur = val;\r\n        }\r\n    }\r\n    function escapeVal(str) {\r\n        return str.replace(/&#([0-9]+);/g, function (_, m0) {\r\n            return String.fromCodePoint(parseInt(m0, 10));\r\n        }).replace(/&#x([0-9a-f]+);/g, function (_, m0) {\r\n            return String.fromCodePoint(parseInt(m0, 16));\r\n        }).replace(/&amp;|&lt;|&gt;|&quot;|&apos;/g, function (_) {\r\n            switch (_) {\r\n                case '&amp;': return '&';\r\n                case '&lt;': return '<';\r\n                case '&gt;': return '>';\r\n                case '&quot;': return '\"';\r\n                case '&apos;': return '\\'';\r\n            }\r\n            return _;\r\n        });\r\n    }\r\n    function parseOpenTag() {\r\n        var r = captureUntil('>');\r\n        var isClosed = false;\r\n        if (r.charCodeAt(r.length - 1) === 47 /* SLASH */) {\r\n            isClosed = true;\r\n            r = r.substring(0, r.length - 1);\r\n        }\r\n        return {\r\n            name: r.trim(),\r\n            isClosed: isClosed\r\n        };\r\n    }\r\n    function parseTagValue(tag) {\r\n        if (tag.isClosed) {\r\n            return '';\r\n        }\r\n        var val = captureUntil('</');\r\n        advanceUntil('>');\r\n        return escapeVal(val);\r\n    }\r\n    while (pos < len) {\r\n        skipWhitespace();\r\n        if (pos >= len) {\r\n            break;\r\n        }\r\n        var chCode = content.charCodeAt(pos);\r\n        advancePosBy(1);\r\n        if (chCode !== 60 /* LESS_THAN */) {\r\n            fail('expected <');\r\n        }\r\n        if (pos >= len) {\r\n            fail('unexpected end of input');\r\n        }\r\n        var peekChCode = content.charCodeAt(pos);\r\n        if (peekChCode === 63 /* QUESTION_MARK */) {\r\n            advancePosBy(1);\r\n            advanceUntil('?>');\r\n            continue;\r\n        }\r\n        if (peekChCode === 33 /* EXCLAMATION_MARK */) {\r\n            advancePosBy(1);\r\n            if (advanceIfStartsWith('--')) {\r\n                advanceUntil('-->');\r\n                continue;\r\n            }\r\n            advanceUntil('>');\r\n            continue;\r\n        }\r\n        if (peekChCode === 47 /* SLASH */) {\r\n            advancePosBy(1);\r\n            skipWhitespace();\r\n            if (advanceIfStartsWith('plist')) {\r\n                advanceUntil('>');\r\n                continue;\r\n            }\r\n            if (advanceIfStartsWith('dict')) {\r\n                advanceUntil('>');\r\n                leaveDict();\r\n                continue;\r\n            }\r\n            if (advanceIfStartsWith('array')) {\r\n                advanceUntil('>');\r\n                leaveArray();\r\n                continue;\r\n            }\r\n            fail('unexpected closed tag');\r\n        }\r\n        var tag = parseOpenTag();\r\n        switch (tag.name) {\r\n            case 'dict':\r\n                enterDict();\r\n                if (tag.isClosed) {\r\n                    leaveDict();\r\n                }\r\n                continue;\r\n            case 'array':\r\n                enterArray();\r\n                if (tag.isClosed) {\r\n                    leaveArray();\r\n                }\r\n                continue;\r\n            case 'key':\r\n                acceptKey(parseTagValue(tag));\r\n                continue;\r\n            case 'string':\r\n                acceptString(parseTagValue(tag));\r\n                continue;\r\n            case 'real':\r\n                acceptReal(parseFloat(parseTagValue(tag)));\r\n                continue;\r\n            case 'integer':\r\n                acceptInteger(parseInt(parseTagValue(tag), 10));\r\n                continue;\r\n            case 'date':\r\n                acceptDate(new Date(parseTagValue(tag)));\r\n                continue;\r\n            case 'data':\r\n                acceptData(parseTagValue(tag));\r\n                continue;\r\n            case 'true':\r\n                parseTagValue(tag);\r\n                acceptBool(true);\r\n                continue;\r\n            case 'false':\r\n                parseTagValue(tag);\r\n                acceptBool(false);\r\n                continue;\r\n        }\r\n        if (/^plist/.test(tag.name)) {\r\n            continue;\r\n        }\r\n        fail('unexpected opened tag ' + tag.name);\r\n    }\r\n    return cur;\r\n}\r\n//# sourceMappingURL=main.js.map","const instanceOfAny = (object, constructors) => constructors.some(c => object instanceof c);\n\nlet idbProxyableTypes;\r\nlet cursorAdvanceMethods;\r\n// This is a function to prevent it throwing up in node environments.\r\nfunction getIdbProxyableTypes() {\r\n    return (idbProxyableTypes ||\r\n        (idbProxyableTypes = [\r\n            IDBDatabase,\r\n            IDBObjectStore,\r\n            IDBIndex,\r\n            IDBCursor,\r\n            IDBTransaction,\r\n        ]));\r\n}\r\n// This is a function to prevent it throwing up in node environments.\r\nfunction getCursorAdvanceMethods() {\r\n    return (cursorAdvanceMethods ||\r\n        (cursorAdvanceMethods = [\r\n            IDBCursor.prototype.advance,\r\n            IDBCursor.prototype.continue,\r\n            IDBCursor.prototype.continuePrimaryKey,\r\n        ]));\r\n}\r\nconst cursorRequestMap = new WeakMap();\r\nconst transactionDoneMap = new WeakMap();\r\nconst transactionStoreNamesMap = new WeakMap();\r\nconst transformCache = new WeakMap();\r\nconst reverseTransformCache = new WeakMap();\r\nfunction promisifyRequest(request) {\r\n    const promise = new Promise((resolve, reject) => {\r\n        const unlisten = () => {\r\n            request.removeEventListener('success', success);\r\n            request.removeEventListener('error', error);\r\n        };\r\n        const success = () => {\r\n            resolve(wrap(request.result));\r\n            unlisten();\r\n        };\r\n        const error = () => {\r\n            reject(request.error);\r\n            unlisten();\r\n        };\r\n        request.addEventListener('success', success);\r\n        request.addEventListener('error', error);\r\n    });\r\n    promise\r\n        .then(value => {\r\n        // Since cursoring reuses the IDBRequest (*sigh*), we cache it for later retrieval\r\n        // (see wrapFunction).\r\n        if (value instanceof IDBCursor) {\r\n            cursorRequestMap.set(value, request);\r\n        }\r\n        // Catching to avoid \"Uncaught Promise exceptions\"\r\n    })\r\n        .catch(() => { });\r\n    // This mapping exists in reverseTransformCache but doesn't doesn't exist in transformCache. This\r\n    // is because we create many promises from a single IDBRequest.\r\n    reverseTransformCache.set(promise, request);\r\n    return promise;\r\n}\r\nfunction cacheDonePromiseForTransaction(tx) {\r\n    // Early bail if we've already created a done promise for this transaction.\r\n    if (transactionDoneMap.has(tx))\r\n        return;\r\n    const done = new Promise((resolve, reject) => {\r\n        const unlisten = () => {\r\n            tx.removeEventListener('complete', complete);\r\n            tx.removeEventListener('error', error);\r\n            tx.removeEventListener('abort', error);\r\n        };\r\n        const complete = () => {\r\n            resolve();\r\n            unlisten();\r\n        };\r\n        const error = () => {\r\n            reject(tx.error);\r\n            unlisten();\r\n        };\r\n        tx.addEventListener('complete', complete);\r\n        tx.addEventListener('error', error);\r\n        tx.addEventListener('abort', error);\r\n    });\r\n    // Cache it for later retrieval.\r\n    transactionDoneMap.set(tx, done);\r\n}\r\nlet idbProxyTraps = {\r\n    get(target, prop, receiver) {\r\n        if (target instanceof IDBTransaction) {\r\n            // Special handling for transaction.done.\r\n            if (prop === 'done')\r\n                return transactionDoneMap.get(target);\r\n            // Polyfill for objectStoreNames because of Edge.\r\n            if (prop === 'objectStoreNames') {\r\n                return target.objectStoreNames || transactionStoreNamesMap.get(target);\r\n            }\r\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\r\n            if (prop === 'store') {\r\n                return receiver.objectStoreNames[1]\r\n                    ? undefined\r\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\r\n            }\r\n        }\r\n        // Else transform whatever we get back.\r\n        return wrap(target[prop]);\r\n    },\r\n    has(target, prop) {\r\n        if (target instanceof IDBTransaction &&\r\n            (prop === 'done' || prop === 'store')) {\r\n            return true;\r\n        }\r\n        return prop in target;\r\n    },\r\n};\r\nfunction addTraps(callback) {\r\n    idbProxyTraps = callback(idbProxyTraps);\r\n}\r\nfunction wrapFunction(func) {\r\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\r\n    // only create one new func per func.\r\n    // Edge doesn't support objectStoreNames (booo), so we polyfill it here.\r\n    if (func === IDBDatabase.prototype.transaction &&\r\n        !('objectStoreNames' in IDBTransaction.prototype)) {\r\n        return function (storeNames, ...args) {\r\n            const tx = func.call(unwrap(this), storeNames, ...args);\r\n            transactionStoreNamesMap.set(tx, storeNames.sort ? storeNames.sort() : [storeNames]);\r\n            return wrap(tx);\r\n        };\r\n    }\r\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\r\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\r\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\r\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\r\n    // undefined if the end of the cursor has been reached.\r\n    if (getCursorAdvanceMethods().includes(func)) {\r\n        return function (...args) {\r\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\r\n            // the original object.\r\n            func.apply(unwrap(this), args);\r\n            return wrap(cursorRequestMap.get(this));\r\n        };\r\n    }\r\n    return function (...args) {\r\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\r\n        // the original object.\r\n        return wrap(func.apply(unwrap(this), args));\r\n    };\r\n}\r\nfunction transformCachableValue(value) {\r\n    if (typeof value === 'function')\r\n        return wrapFunction(value);\r\n    // This doesn't return, it just creates a 'done' promise for the transaction,\r\n    // which is later returned for transaction.done (see idbObjectHandler).\r\n    if (value instanceof IDBTransaction)\r\n        cacheDonePromiseForTransaction(value);\r\n    if (instanceOfAny(value, getIdbProxyableTypes()))\r\n        return new Proxy(value, idbProxyTraps);\r\n    // Return the same value back if we're not going to transform it.\r\n    return value;\r\n}\r\nfunction wrap(value) {\r\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\r\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\r\n    if (value instanceof IDBRequest)\r\n        return promisifyRequest(value);\r\n    // If we've already transformed this value before, reuse the transformed value.\r\n    // This is faster, but it also provides object equality.\r\n    if (transformCache.has(value))\r\n        return transformCache.get(value);\r\n    const newValue = transformCachableValue(value);\r\n    // Not all types are transformed.\r\n    // These may be primitive types, so they can't be WeakMap keys.\r\n    if (newValue !== value) {\r\n        transformCache.set(value, newValue);\r\n        reverseTransformCache.set(newValue, value);\r\n    }\r\n    return newValue;\r\n}\r\nconst unwrap = (value) => reverseTransformCache.get(value);\n\nexport { wrap as a, addTraps as b, instanceOfAny as c, reverseTransformCache as d, unwrap as e };\n","import { a as wrap, b as addTraps } from './chunk.js';\nexport { e as unwrap, a as wrap } from './chunk.js';\n\n/**\r\n * Open a database.\r\n *\r\n * @param name Name of the database.\r\n * @param version Schema version.\r\n * @param callbacks Additional callbacks.\r\n */\r\nfunction openDB(name, version, { blocked, upgrade, blocking } = {}) {\r\n    const request = indexedDB.open(name, version);\r\n    const openPromise = wrap(request);\r\n    if (upgrade) {\r\n        request.addEventListener('upgradeneeded', event => {\r\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction));\r\n        });\r\n    }\r\n    if (blocked)\r\n        request.addEventListener('blocked', () => blocked());\r\n    if (blocking) {\r\n        openPromise.then(db => db.addEventListener('versionchange', blocking)).catch(() => { });\r\n    }\r\n    return openPromise;\r\n}\r\n/**\r\n * Delete a database.\r\n *\r\n * @param name Name of the database.\r\n */\r\nfunction deleteDB(name, { blocked } = {}) {\r\n    const request = indexedDB.deleteDatabase(name);\r\n    if (blocked)\r\n        request.addEventListener('blocked', () => blocked());\r\n    return wrap(request).then(() => undefined);\r\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\r\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\r\nconst cachedMethods = new Map();\r\nfunction getMethod(target, prop) {\r\n    if (!(target instanceof IDBDatabase &&\r\n        !(prop in target) &&\r\n        typeof prop === 'string')) {\r\n        return;\r\n    }\r\n    if (cachedMethods.get(prop))\r\n        return cachedMethods.get(prop);\r\n    const targetFuncName = prop.replace(/FromIndex$/, '');\r\n    const useIndex = prop !== targetFuncName;\r\n    const isWrite = writeMethods.includes(targetFuncName);\r\n    if (\r\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\r\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\r\n        !(isWrite || readMethods.includes(targetFuncName))) {\r\n        return;\r\n    }\r\n    const method = async function (storeName, ...args) {\r\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\r\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\r\n        let target = tx.store;\r\n        if (useIndex)\r\n            target = target.index(args.shift());\r\n        const returnVal = target[targetFuncName](...args);\r\n        if (isWrite)\r\n            await tx.done;\r\n        return returnVal;\r\n    };\r\n    cachedMethods.set(prop, method);\r\n    return method;\r\n}\r\naddTraps(oldTraps => ({\r\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\r\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\r\n}));\n\nexport { openDB, deleteDB };\n"],"sourceRoot":""}